<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Downloader - TikTok & YouTube Tanpa Watermark</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif}
        body {background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#333;line-height:1.6;min-height:100vh;padding:20px}
        .container {max-width:1200px;margin:0 auto}
        header {text-align:center;padding:30px 0;color:white}
        header h1 {font-size:2.8rem;margin-bottom:10px;text-shadow:2px 2px 4px rgba(0,0,0,0.2)}
        .logo {display:flex;justify-content:center;gap:15px;margin-bottom:20px}
        .logo i {font-size:3rem;color:#fff}
        .main-content {display:flex;flex-wrap:wrap;gap:30px;margin-bottom:40px}
        .download-section,.info-section {flex:1;min-width:300px;background:white;border-radius:15px;padding:30px;box-shadow:0 15px 30px rgba(0,0,0,.15)}
        .section-title {font-size:1.8rem;color:#4a5568;margin-bottom:20px;display:flex;align-items:center;gap:10px}
        .section-title i {color:#667eea}
        .platform-selector {display:flex;gap:10px;margin-bottom:25px}
        .platform-btn {flex:1;padding:12px;border:2px solid #e2e8f0;background:#f7fafc;border-radius:8px;display:flex;align-items:center;justify-content:center;gap:10px;cursor:pointer;transition:.3s;font-weight:600}
        .platform-btn.active {background:#667eea;color:white;border-color:#667eea}
        .url-input {width:100%;padding:15px;border:2px solid #e2e8f0;border-radius:10px;font-size:1rem;transition:.3s}
        .url-input:focus {outline:none;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,.2)}
        .download-btn {width:100%;padding:16px;background:linear-gradient(to right,#667eea,#764ba2);color:white;border:none;border-radius:10px;font-size:1.1rem;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;transition:.3s}
        .download-btn:hover {transform:translateY(-3px);box-shadow:0 10px 20px rgba(0,0,0,.2)}
        .alert {padding:15px;border-radius:8px;margin-bottom:20px;display:none}
        .alert.success {background:#d4edda;color:#155724;border:1px solid #c3e6cb}
        .alert.error {background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}
        .loading {display:none;text-align:center;padding:20px}
        .spinner {border:4px solid rgba(0,0,0,0.1);width:36px;height:36px;border-radius:50%;border-left-color:#667eea;animation:spin 1s linear infinite;margin:0 auto 15px}
        @keyframes spin {0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
        .result-section {background:white;border-radius:15px;padding:30px;margin-top:30px;display:none;box-shadow:0 15px 30px rgba(0,0,0,.15)}
        .video-preview {max-width:300px;margin:0 auto 30px;border-radius:10px;overflow:hidden;box-shadow:0 5px 15px rgba(0,0,0,.1)}
        .download-options {display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px}
        .option-btn {padding:15px;background:#f7fafc;border:2px solid #e2e8f0;border-radius:8px;cursor:pointer;display:flex;align-items:center;justify-content:space-between;transition:.3s}
        .option-btn:hover {background:#edf2f7;border-color:#667eea}
        footer {text-align:center;color:white;padding:20px;margin-top:30px;opacity:.8}
    </style>
</head>
<body>
<div class="container">
<header>
    <div class="logo">
        <i class="fas fa-video"></i>
        <i class="fas fa-download"></i>
    </div>
    <h1>Video Downloader Pro</h1>
    <p>Download video TikTok & YouTube tanpa watermark.</p>
</header>

<div class="alert success" id="successAlert">
    <i class="fas fa-check-circle"></i> Video berhasil diproses!
</div>

<div class="alert error" id="errorAlert">
    <i class="fas fa-exclamation-circle"></i> Terjadi kesalahan.
</div>

<div class="main-content">
<div class="download-section">
    <h2 class="section-title"><i class="fas fa-download"></i> Download Video</h2>
    <div class="platform-selector">
        <div class="platform-btn active" data-platform="tiktok"><i class="fab fa-tiktok"></i> TikTok</div>
        <div class="platform-btn" data-platform="youtube"><i class="fab fa-youtube"></i> YouTube</div>
    </div>
    <label>Masukkan Link Video:</label>
    <input type="text" id="videoUrl" class="url-input">
    <button class="download-btn" id="processBtn"><i class="fas fa-cogs"></i> Proses Video</button>
    <div class="loading" id="loading">
        <div class="spinner"></div><p>Memproses...</p>
    </div>
</div>

<div class="info-section">
    <h2 class="section-title"><i class="fas fa-info-circle"></i> Info</h2>
    <p>Gunakan dengan bijak.</p>
</div>
</div>

<div class="result-section" id="resultSection">
    <h2 class="section-title"><i class="fas fa-film"></i> Hasil Video</h2>
    <div class="video-preview"><img id="videoThumbnail" src=""></div>
    <h3 id="videoTitle"></h3>
    <p id="videoDescription"></p>
    <div class="download-options" id="downloadOptions"></div>
</div>

<footer><p>&copy; 2023 Video Downloader Pro</p></footer>
</div>

<script>
let selectedPlatform = "tiktok";

document.querySelectorAll(".platform-btn").forEach(btn=>{
 btn.onclick=()=>{
  document.querySelectorAll(".platform-btn").forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
  selectedPlatform = btn.dataset.platform;
  if(selectedPlatform==="youtube") alert("YouTube belum tersedia.");
 };
});

async function fetchTikTokAPI(url){
 const r = await fetch(`/api/tiktok?url=${encodeURIComponent(url)}`);
 if(!r.ok) throw new Error("Backend error");
 return r.json();
}

function showError(msg){
 const e=document.getElementById("errorAlert");
 e.style.display="block"; e.innerHTML=`<i class='fas fa-exclamation-circle'></i> ${msg}`;
}

function showSuccess(){
 document.getElementById("successAlert").style.display="block";
}

function displayVideoData(v){
 document.getElementById("resultSection").style.display="block";
 document.getElementById("videoThumbnail").src=v.thumbnail;
 document.getElementById("videoTitle").textContent=v.title;
 document.getElementById("videoDescription").textContent=v.description;
 document.getElementById("downloadOptions").innerHTML=
 `<div class='option-btn' onclick='window.open("${v.url}", "_blank")'>
   <div><div class='quality'>MP4 (No Watermark)</div></div>
   <i class='fas fa-download'></i>
 </div>`;
}

async function processVideo(){
 const link=document.getElementById("videoUrl").value.trim();
 document.getElementById("loading").style.display="block";
 if(!link || !link.includes("tiktok.com")){
   showError("Masukkan link TikTok valid.");
   document.getElementById("loading").style.display="none";
   return;
 }
 try{
   const api=await fetchTikTokAPI(link);
   displayVideoData({
     title:api.description,
     description:api.author.nickname,
     thumbnail:api.cover,
     url:api.downloadUrl
   });
   showSuccess();
 }catch(e){ showError("Gagal memproses."); }
 document.getElementById("loading").style.display="none";
}

document.getElementById("processBtn").onclick=processVideo;
</script>
</body>
</html>
